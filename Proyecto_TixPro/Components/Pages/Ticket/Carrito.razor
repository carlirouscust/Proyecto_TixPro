@page "/Ticket/Carrito/{eventoId:int}&{ticketId:int}"
@inject EventosService eventosService
@inject UsuariosService usuarioService
@inject TicketService ticketSercive
@rendermode InteractiveServer
@inject NavigationManager navigationManager

<PageTitle>TixPro - Carrito</PageTitle>

<h3>Carrito de Compras</h3>
<EditForm Model="evento">
    <div class="main-container">
        <div class="row">
        <!-- Contenedor Izquierdo: Detalles del Evento -->
        <div class="left-container col-md-6">
            <h4>Datos de contacto</h4>
                <div class="form-floating mb-3">
                    <label for="Nombres" style="font-size: 1rem;">Nombre completo:</label>
                    <InputText @bind-Value="usuario.nombre" class="form-control col-md-6" placeholder="Nombre completo:" style="font-size: 1.1rem;" />
                <ValidationMessage For="@(() => usuario.nombre)" />
            </div>
                <div class="form-floating mb-3">
                    <label for="Correo" style="font-size: 1rem;">Correo electrónico:</label>
                    <InputText @bind-Value="evento.nombre" class="form-control col-md-6" placeholder="Correo electrónico:" style="font-size: 1.1rem;" />
                <ValidationMessage For="@(() => usuario.nombre)" />
            </div>

            <h4>Información de pago</h4>
        </div>


        <!-- Contenedor Derecho: Carrito de Compras -->
        <div class="right-container col-md-6">
            <!-- Fila (row) para contener la imagen y el contenido de texto -->
            <div class="row align-items-center">
                <!-- Columna para la imagen -->
                <div class="col-md-6 d-flex justify-content-center">
                    <img class="card-img" src="@evento.imagen" alt="Imagen del Evento" style="height: 300px; width: auto;">
                </div>
                <!-- Columna para el contenido de texto -->
                <div class="col-md-6">
                    <div class="card-body">
                        <h5 class="fw-bold">@evento.nombre</h5>
                        <p><i class="bi bi-calendar4-week"></i> @evento.lugar</p>
                        <p><i class="bi bi-geo-alt"></i> @evento.fecha</p>
                    </div>
                    <hr />
                        <p class="text-muted">
                            <span class="text-dark fw-bold">Precio: RD$ @evento.precio</span>                           
                        </p>
                        <p class="text-muted">
                            <span class="text-dark fw-bold">Cantidad: @ticket.cantidad</span>
                        </p>                       
                    <hr />
                        <h6>Sub Total: RD$ @montoTemporal</h6>
                    <h6>Cargo de Servicio: RD$ @(cargo * ticket.cantidad)</h6>
                    <hr />
                        <h6>Total a Pagar: RD$ @ticket.monto </h6>
                </div>
            </div>
        </div>
        </div>
    </div>
</EditForm>

<!-- Footer-->
<footer class="py-5 bg-dark" style="border-top-left-radius: 20px; border-top-right-radius: 20px;">
    <div class="container"><p class="m-0 text-center text-white">Copyright  &copy; Ozcudi-Studios </p></div>
</footer>
@code {
    [Parameter]
    public int eventoId { get; set; }
    [Parameter]
    public int ticketId { get; set; }
    public Evento evento { get; set; } = new Evento();
    public int usuarioId { get; set; }
    public Usuario usuario { get; set; } = new Usuario();
    public Ticket ticket { get; set; } = new Ticket();
    public decimal cargo = 10;
    public decimal montoTemporal;

    protected override async Task OnInitializedAsync()
    {
        evento = await eventosService.Buscar(eventoId);       
        ticket = await ticketSercive.Buscar(ticketId);       
        CalcularTotal();
    }



    private void CalcularTotal()
    {   
        montoTemporal = ticket.monto;
        ticket.monto += (cargo * ticket.cantidad);   
    }

}
